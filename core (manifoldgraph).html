<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Implementation and low-level documentation">

<title>diffusion_curvature - Implementation (Manifold Graph)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="diffusion_curvature - Implementation (Manifold Graph)">
<meta property="og:description" content="Implementation and low-level documentation">
<meta property="og:image" content="https://professorwug.github.io/diffusion_curvature/Core (manifoldgraph)_files/figure-html/cell-13-output-2.png">
<meta property="og:site-name" content="diffusion_curvature">
<meta property="og:image:height" content="790">
<meta property="og:image:width" content="769">
<meta name="twitter:title" content="diffusion_curvature - Implementation (Manifold Graph)">
<meta name="twitter:description" content="Implementation and low-level documentation">
<meta name="twitter:image" content="https://professorwug.github.io/diffusion_curvature/Core (manifoldgraph)_files/figure-html/cell-13-output-2.png">
<meta name="twitter:image-height" content="790">
<meta name="twitter:image-width" content="769">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">diffusion_curvature</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./core (manifoldgraph).html">Implementation (Manifold Graph)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diffusion Curvature</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core (graphtools).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Implementation (Graphtools)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core (manifoldgraph).html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementation (Manifold Graph)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core (pyg).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Implementation (Pytorch Geometric)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kernels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kernels</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manifold distances.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manifold Distances</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#manifoldgraph" id="toc-manifoldgraph" class="nav-link active" data-scroll-target="#manifoldgraph">ManifoldGraph</a></li>
  <li><a href="#power_diffusion_matrix" id="toc-power_diffusion_matrix" class="nav-link" data-scroll-target="#power_diffusion_matrix">power_diffusion_matrix</a></li>
  <li><a href="#phate-distances" id="toc-phate-distances" class="nav-link" data-scroll-target="#phate-distances">PHATE Distances</a>
  <ul class="collapse">
  <li><a href="#phate_distances" id="toc-phate_distances" class="nav-link" data-scroll-target="#phate_distances">phate_distances</a></li>
  </ul></li>
  <li><a href="#the-wasserstein-diffusion-curvature" id="toc-the-wasserstein-diffusion-curvature" class="nav-link" data-scroll-target="#the-wasserstein-diffusion-curvature">The Wasserstein Diffusion Curvature</a>
  <ul class="collapse">
  <li><a href="#wasserstein_spread_of_diffusion" id="toc-wasserstein_spread_of_diffusion" class="nav-link" data-scroll-target="#wasserstein_spread_of_diffusion">wasserstein_spread_of_diffusion</a></li>
  <li><a href="#entropy_of_diffusion" id="toc-entropy_of_diffusion" class="nav-link" data-scroll-target="#entropy_of_diffusion">entropy_of_diffusion</a></li>
  <li><a href="#flattened_facsimile_of_graph" id="toc-flattened_facsimile_of_graph" class="nav-link" data-scroll-target="#flattened_facsimile_of_graph">flattened_facsimile_of_graph</a></li>
  <li><a href="#diffusion_curvature" id="toc-diffusion_curvature" class="nav-link" data-scroll-target="#diffusion_curvature">diffusion_curvature</a></li>
  <li><a href="#diffusion_entropy_curvature" id="toc-diffusion_entropy_curvature" class="nav-link" data-scroll-target="#diffusion_entropy_curvature">diffusion_entropy_curvature</a></li>
  <li><a href="#plot_manifold_curvature" id="toc-plot_manifold_curvature" class="nav-link" data-scroll-target="#plot_manifold_curvature">plot_manifold_curvature</a></li>
  </ul></li>
  <li><a href="#use-on-data" id="toc-use-on-data" class="nav-link" data-scroll-target="#use-on-data">Use on Data</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/professorwug/diffusion_curvature/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Implementation (Manifold Graph)</h1>
</div>

<div>
  <div class="description">
    Implementation and low-level documentation
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>This notebook establishes the core of the diffusion curvature library. Our implementation is structured around the <a href="https://professorwug.github.io/diffusion_curvature/core%20(manifoldgraph).html#manifoldgraph"><code>ManifoldGraph</code></a> class, which stores all of the relevant information for our geometric analysis. Below this, we define various transforms on the manifold graph: 1. Powering the diffusion matrix 2. Computing Heat Geodesic Distances 3. Computing the wasserstein spread of diffusino among others.</p>
<p>When convenient, we define each transform directly within this notebook. For some transforms, extra implementation is needed; we source those to other notebooks.</p>
<hr>
<p><a href="https://github.com/professorwug/diffusion_curvature/blob/main/diffusion_curvature/manifold_graph.py#L12" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="manifoldgraph" class="level3">
<h3 class="anchored" data-anchor-id="manifoldgraph">ManifoldGraph</h3>
<blockquote class="blockquote">
<pre><code> ManifoldGraph (X=None, dimension=None, kernel_type:str='adaptive',
                anisotropic_density_normalization:float=1,
                num_neighbors=10, t=10, A=None, P=None, Pt=None, D=None,
                *kw_args)</code></pre>
</blockquote>
<p>Class for Manifold Graphs. Stores the basic graph information used for geometric analysis: A (the affinity/adjacency matrix), P (the diffusion matrix), P^t (the powered diffusion matrix), and D (the manifold distance matrix) Takes raw points, X. Can also optionally pass in any of the above to save the trouble of recomputing it.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X</td>
<td>NoneType</td>
<td>None</td>
<td>raw points</td>
</tr>
<tr class="even">
<td>dimension</td>
<td>NoneType</td>
<td>None</td>
<td>dimension of manifold.</td>
</tr>
<tr class="odd">
<td>kernel_type</td>
<td>str</td>
<td>adaptive</td>
<td>“fixed” or “adaptive”</td>
</tr>
<tr class="even">
<td>anisotropic_density_normalization</td>
<td>float</td>
<td>1</td>
<td>normalize out this amount of the density. 0 is none. 1 is all.</td>
</tr>
<tr class="odd">
<td>num_neighbors</td>
<td>int</td>
<td>10</td>
<td>for adaptive kernel, constructs graph to connect this number of neighbors</td>
</tr>
<tr class="even">
<td>t</td>
<td>int</td>
<td>10</td>
<td>steps of diffusion</td>
</tr>
<tr class="odd">
<td>A</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>P</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>Pt</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>D</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>kw_args</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/professorwug/diffusion_curvature/blob/main/diffusion_curvature/manifold_graph.py#L46" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="power_diffusion_matrix" class="level3">
<h3 class="anchored" data-anchor-id="power_diffusion_matrix">power_diffusion_matrix</h3>
<blockquote class="blockquote">
<pre><code> power_diffusion_matrix (G:__main__.ManifoldGraph, t:int=None)</code></pre>
</blockquote>
</section>
<section id="phate-distances" class="level2">
<h2 class="anchored" data-anchor-id="phate-distances">PHATE Distances</h2>
<p>Wasserstein Diffusion Curvature – despite the name – requires only manifold distances. This saves quite a bit of computation, but doesn’t alleviate the need for a good approximation of the manifold’s geodesic distance. Here, we implement one straightforward and accurate manifold distance: that proposed by Moon et al.&nbsp;in PHATE (2019). The PHATE distance is an extension of the diffusion distance, except instead of calculating the L2 distances between diffusion coordinates (which corresponds roughly to the rows of the diffusion matrix), it takes the L2 distances between the log-transformed diffusions. This flips the weighting from local to global, as a diffusion that assigns a small mass where another assigns a miniscule mass becomes much further than those that differ only at their centers. This log transform has the additional advantage of, through the WAWA formulation of the heat equation, recovering the distance term.</p>
<p>It is defined as: <span class="math display">\[d_p(x,y) = \| \log(p_y^t)-\log(p_x^t) \|_2 \]</span></p>
<hr>
<section id="phate_distances" class="level3">
<h3 class="anchored" data-anchor-id="phate_distances">phate_distances</h3>
<blockquote class="blockquote">
<pre><code> phate_distances (x, **kwargs)</code></pre>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>
</section>
</section>
<section id="the-wasserstein-diffusion-curvature" class="level1">
<h1>The Wasserstein Diffusion Curvature</h1>
<p>This has two components: computing the spread of diffusion, and computing a “flattened facsimile” of the graph.</p>
<p>For the second, we presently give a naive implementation that presumes the dimensionality is known and constructs random noise of the same dimension and size.</p>
<hr>
<p><a href="https://github.com/professorwug/diffusion_curvature/blob/main/diffusion_curvature/manifold_graph.py#L66" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="wasserstein_spread_of_diffusion" class="level3">
<h3 class="anchored" data-anchor-id="wasserstein_spread_of_diffusion">wasserstein_spread_of_diffusion</h3>
<blockquote class="blockquote">
<pre><code> wasserstein_spread_of_diffusion (G:__main__.ManifoldGraph, idx=None)</code></pre>
</blockquote>
<p>Returns how “spread out” each diffusion is, with wasserstein distance” Presumes that the manifold distances have been separately calculated If idx is passed, only computes wsd at that index</p>
<hr>
<p><a href="https://github.com/professorwug/diffusion_curvature/blob/main/diffusion_curvature/manifold_graph.py#L83" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="entropy_of_diffusion" class="level3">
<h3 class="anchored" data-anchor-id="entropy_of_diffusion">entropy_of_diffusion</h3>
<blockquote class="blockquote">
<pre><code> entropy_of_diffusion (G:__main__.ManifoldGraph, idx=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/professorwug/diffusion_curvature/blob/main/diffusion_curvature/manifold_graph.py#L91" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="flattened_facsimile_of_graph" class="level3">
<h3 class="anchored" data-anchor-id="flattened_facsimile_of_graph">flattened_facsimile_of_graph</h3>
<blockquote class="blockquote">
<pre><code> flattened_facsimile_of_graph (G:__main__.ManifoldGraph, dimension=None)</code></pre>
</blockquote>
<hr>
</section>
<section id="diffusion_curvature" class="level3">
<h3 class="anchored" data-anchor-id="diffusion_curvature">diffusion_curvature</h3>
<blockquote class="blockquote">
<pre><code> diffusion_curvature (x, **kwargs)</code></pre>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>
<hr>
</section>
<section id="diffusion_entropy_curvature" class="level3">
<h3 class="anchored" data-anchor-id="diffusion_entropy_curvature">diffusion_entropy_curvature</h3>
<blockquote class="blockquote">
<pre><code> diffusion_entropy_curvature (x, **kwargs)</code></pre>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>
<hr>
<p><a href="https://github.com/professorwug/diffusion_curvature/blob/main/diffusion_curvature/manifold_graph.py#L137" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_manifold_curvature" class="level3">
<h3 class="anchored" data-anchor-id="plot_manifold_curvature">plot_manifold_curvature</h3>
<blockquote class="blockquote">
<pre><code> plot_manifold_curvature (G:__main__.ManifoldGraph, title=None)</code></pre>
</blockquote>
</section>
</section>
<section id="use-on-data" class="level1">
<h1>Use on Data</h1>
<p>To compute the wasserstein diffusion curvature of the data, first put the data into your <a href="https://professorwug.github.io/diffusion_curvature/core%20(manifoldgraph).html#manifoldgraph"><code>ManifoldGraph</code></a> object. Supply the dimension of the data, if you know it. Also select the parameters for creating an affinity matrix: the kernel type, the number of neighbors to use, and the degree of anisotropic density normalization.</p>
<p>If you’re unsure what value to put for any of these, leave it blank. We’ll use heuristics to find a good value for t and use our own dimension fitting to find a good value for that.</p>
<p>Alternately, if already have a graph (A), or any other piece of the puzzle, just supply it as an argument when initializing the <a href="https://professorwug.github.io/diffusion_curvature/core%20(manifoldgraph).html#manifoldgraph"><code>ManifoldGraph</code></a> class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> diffusion_curvature.datasets <span class="im">import</span> <span class="op">*</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>X_torus, k_torus_real <span class="op">=</span> torus(n<span class="op">=</span><span class="dv">4000</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"num nodes"</span>, <span class="bu">len</span>(X_torus))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>num nodes 1973</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>G_torus <span class="op">=</span> ManifoldGraph(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X_torus, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    dimension<span class="op">=</span> <span class="dv">2</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="dv">8</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    anisotropic_density_normalization<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>G_torus <span class="op">=</span> diffusion_curvature(G_torus)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plot_manifold_curvature(G_torus, title<span class="op">=</span><span class="st">"Wasserstein (With subtraction)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/piriac/mambaforge/envs/diffusion_curvature/lib/python3.11/site-packages/sklearn/utils/extmath.py:193: RuntimeWarning: invalid value encountered in matmul
  ret = a @ b
/home/piriac/mambaforge/envs/diffusion_curvature/lib/python3.11/site-packages/sklearn/utils/extmath.py:193: RuntimeWarning: invalid value encountered in matmul
  ret = a @ b</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Core (manifoldgraph)_files/figure-html/cell-13-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>G_torus <span class="op">=</span> diffusion_entropy_curvature(G_torus)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plot_manifold_curvature(G_torus, <span class="st">"Entropy (with subtraction)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6.311028761552304</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Core (manifoldgraph)_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>k_torus_real</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([ 0.99457493,  1.32435208,  0.41629848, ...,  1.32025171,
       -0.84067858, -0.63401814])</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>